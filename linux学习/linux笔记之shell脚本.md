## 一、shell概述
1. shell是系统跟计算机硬件交互时使用的中间介质，它是系统的一个工具
2. bash(Bourne Again Shell)是sh(Bourne Shell)的增强版本

## 二、bash特点
1. 记录命令历史
	+ linux预设可以记录1000条我们敲过的命令，这些命令保存在用户的家目录中的`.bash_history`文件中
	+ `!!` 执行上一条指令			
	+ `!n` 执行上n条命令(n为负整数)
	+ `!字符串` 执行命令历史中最近一次以字符串开头的指令(字符串长度大于等于1)
2. 指令和文件名补全
	+ `tab`键可以补全一个指令，也可以补全一个路径或者一个文件名
	+ `tab`键连续按两次，系统则会把所有的指令或者文件名列出来
3. 别名
	+ `alias` 把一个常用的并且很长的指令别名一个简洁易记的指令
	+ `unalias` 解除别名
4. 通配符
	+ `*` 用来匹配零个或多个字符
	+ `?` 用来匹配一个字符
5. 输入输出重定向
	+ `<` 输入重定向
	+ `>` 输出重定向
	+ `2>` 错误重定向
	+ `>>` 追加重定向
6. 管道符
	+ `|` 把前面的命令运行的结果丢给后面的命令
7. 作业控制
	+ `Ctrl+Z` 暂停当前进程
	+ `Ctrl+C` 终止当前进程
	+ `fg` 恢复当前进程
	+ `bg` 后台运行
	+ `jobs` 查看当前shell后台执行的任务

## 三、变量及常用配置
1. `/etc/profile` 想系统内所有用户登录后都能使用该变量
2. 用户主目录下的`.bashrc`文件 只想让当前用户使用该变量
	+ 文件末行加入 `export myname=Aming`
	+ `a=b` 等号两边不能有空格
	+ 变量名只能由英、数字以及下划线组成，而且不能以数字开头
	+ 当变量内容带有特殊字符时，需要加上单引号，内容中带有单引号用双引号
	+ 如果变量内容需要用到其他命令运行结果可以使用反引号
	+ 变量内容累加到其他变量需要加双引号
3. `env` `printenv` 显示系统环境变量(`$PATH` `$HOME` `$LOGNNAME`)
4. `set` 系统预设的全部变量都显示出来
5. `export 变量名` 让shell的子shell也知道变量的值,不加变量名则声明所有变量
6. `unset 变量名` 取消某个变量
7. `/etc/bashrc` `$umask` `$PS1` 就是我们敲命令时前面的那串字符串
8. 每个用户的主目录下有几个隐藏文件
	+ `.bash_profile` 定义了用户的个人化路径与环境变量的文件名称
	+ `.bashrc` 该文件包含专用于你的shell的bash信息，当登录时以及每次打开新的shell时，该文件被读取
	+ `.bash_history` 记录命令历史
	+ `.bash_logout` 当退出shell时，会执行该文件，可以把一些清理的工作放到这个文件中。
9. `source` 目前设定的配置刷新

## 四、linux shell中的特殊符号
1. `*` 零个或多个字符或数字
2. `?` 一个任意的字符
3. `#` 注释，后面的内容linux忽略掉
4. `\` 转义字符，后面的特殊符号转义成普通字符
5. `|` 管道符，符号前面的命令结果丢给符号后面的命令
6. `$` 变量前面的标识符，`!$` 表示上条命令中最后出现的那个东西
7. `;` 一行中运行多条命令
8. `~` 用户的家目录
9. `&` 如果想把一条命令放到后台执行的话，需要加上这个符号，通常用于命令运行时间非常长的情况
10. `>` `>>` `2>` `2>>` 重定向 追加 错误重定向 错误追加
11. `[]` 其中字符中任一个(同正则表达式)
12. `&&` `||` 执行成功为true，执行失败为false，遵循短路

## 五、常用命令
1. `bash` 打开一个shell，`exit` 退出当前shell
2. `pstree` 将系统所有进程通过树形结构打印出来
3. `grep` 过滤一个或多个字符	
4. `cut` 截取某一个字段 `-d "分隔字符"`，`[-cf]n` 第几个，第几段
5. `sort` 用作排序
6. `wc` 统计文档的行数、字符数、词数 `-l` `-m` `-w`
7. `uniq` 去重复的行，需要先排序
8. `tee` 包含`>`的功能，同时显示到屏幕上
9. `tr` 替换字符
10. `split -b 500 /etc/passwd passwd` 切割文档

## 六、正则表达式(Regular Expression)
1. 它是指一个用来描述或者匹配一系列符合某个句法规则的字符串的单个字符串
2. `[1-9]` `[123]` `[^123]`
3. `^` 开头，`$` 结尾
4. `.` 表示任意一个字符
5. `*` 零个或多个前面的字符
6. `\{n1,n2\}` n1-n2个，n2省略表示大于等于n1个
7. 支持正则表达式的命令:	`grep`/`egrep` `sed` `awk`

### grep [-cinvABC] 'regex' filename
+ `-c` 打印符合要求的行数
+ `-i` 忽略大小写
+ `-n` 在输出符合要求的行的同时连同行号一起输出
+ `-v` 打印不符合要求的行
+ `-A` 后跟一个数字（有无空格都可以），例如-A2则表示打印符合要求的行以及下面两行
+ `-B` 打印符合要求的行以及上面n行
+ `-C` 打印符合要求的行以及上下各n行

### egrep(grep扩展版)
+ `?` 零个或一个前面的字符
+ `+` 一个或一个以上前面的字符
+ `|` 或者
+ `()` 表示一个整体

### sed
+ `sed -n 'n'p filename` 打印某行
+ `sed -n '1,$'p filename` 打印多行
+ `sed -n '/regex/'p filename` 打印匹配正则的行
+ `sed -e ''p -e ''p -n filename` 实现多个行为
+ `sed 'n'd filename` 删除某行 
+ `sed '1,$'d filename` 删除多行
+ `sed 'n1,n2s/regex/替换后内容/g' filename` 替换n1,n2行中内容，g表示全局，不加g只匹配第一个
+ `sed 's/regex/替换后内容/g' filename` 替换全文内容
+ 除了可以使用`/`以外`#`和`@`也可以
+ `sed 's/\(word1\)\(.*\)\(word2\)/\3\2\1/' filename` 替换两个字符串的位置
+ `sed -i 's/regex/替换后内容/g' filename` 直接修改文件内容

### awk
+ `awk -F':' '{print $1}' filename`
+ `-F` 的作用是指定分隔符，如果不加`-F`指定，则以空格或者tab为分隔符
+ `print` 打印，`$1`第一字段，`$2`第二字段，`$0`表示整行
+ `awk -F':' '{print $1"@"$2"@"$3}'`
+ `awk '/regex/' filename` 匹配字符或字符串
+ `awk -F'分隔符' '$1~/regex/' filename` 某个段去匹配~表示匹配
+ `awk '/regex1/{print $1}/regex2/{print $1}' filename` 多次匹配
+ `awk -F':' '$3=="0"' filename` 还有`>` `>=` `<` `<=` `!=` 但是为字符串的比较`&&` `||`也有
+ `awk的内置变量`
	+ `NF` 用分隔符后一共有多少段
	+ `NR` 行数
	+ `=` 赋值，`END` 所有行都执行完
	+ `awk -F':' '{(tot+=$3)};END {print tot}' filename`
	+ `awk -F':' '{if ($1=="root") print $0}' filename`

## 七、shell脚本
1. shell脚本的基本结构以及如何执行
	+ shell脚本通常是以`.sh`为后缀名的
	+ 第一行一定是`#！/bin/bash` 如果不设置该行，脚本不能被执行
	+ 使用`sh`来执行脚本，`-x` 选项来查看这个脚本的执行过程
	+ `chmod +x file.sh ./file.sh` 加可执行权限后也可直接执行
	+ `date` 打印当前系统时间
2. shell脚本中的变量
	+ 定义变量`变量名=变量值` 变量值为一个命令得到用反引号
	+ 引用变量`$变量名`
	+ 数学计算`$[$a+$b]`
	+ `read`可以从标准输入获得变量的值，后跟变量名，`-p`选项，输入提示语
	+ 预设变量
		+ `$0` 脚本本身名字 
		+ `$1` 脚本执行时的第一个变量
		+ `$2` 脚本执行时的第二个变量
3. shell脚本中的逻辑判断
	+ ```shell
	  if ((判断语句)) ; then
		  command
	  fi
	  ```
	+ ```shell
	  if ((判断语句)) ; then
		  command1
	  else
		  command2
	  fi
	  ```
	+ ```shell
	  if ((判断语句))||((判断语句)) ; then
		  command1
	  elif ((判断语句))&&((判断语句)) ; then
		  command2
	  else
		  command3
	  fi
	  ```
	+ 判断语句可使用`[]`，但要使用`-lt` `-gt` `-le` `-ge` `-eq` `-ne`
	+ `if [-e filename] ; then`
		+ `-e` 判断文件或目录是否存在
		+ `-d` 判断是不是目录，并是否存在
		+ `-f` 判断是否是普通文件，并是否存在
		+ `-r` `-w` `-x` 判断文档是否有相应权限 
	+ ```shell
	  case 变量 in
	  value1)
		  command1
		  ;;
	  value2)
		  command2
		  ;;
	  value3)
		  command3
		  ;;
	  *)
		  command4
		  ;;
	  esac
	  ```
4. shell脚本中的循环
	+ ```shell
	  # 循环的条件
	  # `seq 1 5`，1-5的一个序列
	  # 也可以写 1 2 3 4 5
	  # 还可以是 `ls` `cat test.txt`
	  for 变量名 in 循环的条件; do
		  command
	  done
	  ```
	+ ```shell
	  while [判断语句] ; do
		  command
	  done
	  ```
	+ ```shell
	  # 死循环
	  while :; do
		  command
	  done
	  ```
5. shell脚本中的函数
	+ ```shell
	  # 一定要写在调用函数前
	  function 函数名(){
		  函数体
	  }
	  ```
